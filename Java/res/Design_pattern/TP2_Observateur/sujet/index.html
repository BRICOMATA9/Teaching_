<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <title>Lab #2 -- The Observer Pattern</title>
  <meta http-equiv="content-type"
 content="text/html; charset=ISO-8859-1">
</head>
<body>
<b>CMPT 300 Design Patterns<br>
Mayterm 2012<br>
<br>
Lab 2 The Observer Pattern</b><br>
<hr noshade="noshade" size="1" width="100%"> <br>
<div style="margin-left: 40px;">&lt;&lt; <a href="lab2.zip">lab2.zip</a>
&gt;&gt;<br>
</div>
<blockquote>
  <blockquote> </blockquote>
</blockquote>
<br>
The <span style="font-weight: bold;">Observer Pattern</span> is
a&nbsp; commonly-appearing pattern and has a wide variety of uses. The
pattern allows objects to be notifed when events occur. <br>
<br>
<div style="margin-left: 40px;"><span style="color: rgb(255, 0, 0);">&lt;&lt;</span>
<span style="font-style: italic;">We will motivate the pattern with an
in-class example</span> <span style="color: rgb(255, 0, 0);">&gt;&gt;</span><br>
</div>
<br>
The Observer pattern follows the <span style="font-style: italic;">Subscriber</span>
model whereby <span style="font-weight: bold;">observers</span> (the
subscribers) can register to be notifed when when another object (the <b>subject</b>)
changes
state.
The notification mechanism provides a <i>loose coupling</i>
between
the observers and the subject<span style="font-weight: bold;"></span>
objects
they register with. This allows a one-to-many relationship between the
subject
and the observers:<br>
<br>
<div style="margin-left: 40px;">
<div style="text-align: left; margin-left: 80px;"><img alt="Observer"
 src="observer.jpg" style="width: 536px; height: 250px;"> <br>
</div>
<br>
<br>
</div>
In UML:<br>
<br>
<div style="text-align: left; margin-left: 120px;"><img
 alt="boserver pattern" src="observerpattern.jpg"
 style="width: 770px; height: 360px;" height="360" width="770"> <br>
</div>
<br>
The interfaces:<br>
<br>
<div style="margin-left: 40px;">- <a target="_blank"
 href="Subject.java">Subject.java</a><br>
<br>
- <a target="_blank" href="Observer.java">Observer.java</a><br>
</div>
<br>
An observer must first register itself with the subject via the <big><span
 style="font-family: monospace;">addObserver()</span></big> method.
When the
state of the subject changes, the subject calls the <big><span
 style="font-family: monospace;">update()</span></big> method in the
observer.<br>
<br>
We can illustrate this using UML <b>sequence diagrams</b>:<br>
<br>
<blockquote><img alt="sequence diagram"
 src="observerpatternsequence.jpg" style="width: 550px; height: 260px;"
 height="280" width="665"> <br>
</blockquote>
<br>
<br>
Concrete Implementations:<br>
<br>
<div style="margin-left: 40px;">- <a target="_blank"
 href="BidList.java">BidList.java</a><br>
<br>
- <a target="_blank" href="Bidder.java">Bidder.java</a><br>
<br>
</div>
<br>
An example:<br>
<br>
<div style="margin-left: 40px;">- <a target="_blank"
 href="Auction.java">Auction.java</a><br>
</div>
<br>
Why does each line of output appear multiple times <span
 style="font-weight: bold;"></span><big><big><big><b>?</b></big></big></big><br>
<blockquote><b>&gt;&gt;</b> We will further illustrate this using a UML
sequence diagram <b>&lt;&lt;</b><br>
</blockquote>
<br>
The primary benefit of the observer pattern is that we have <i><b>decoupled</b></i>
the relationship between the object that can change state - the subject
- and the objects&nbsp; that are notifed when a state change occurs -
the observers. Furthermore, we could have different types of
implementations of the <big><tt>Observer</tt></big> interface.<br>
<br>
<table width="50%" align="center" bgcolor="#6666cc" border="0"
 cellpadding="2" cellspacing="2">
  <tbody>
    <tr>
      <td valign="top" bgcolor="#9999ff">
      <div align="center"><b>Push or Pull?</b><br>
      </div>
      <br>
      <div align="center">In this example, when the state of the
subject changes,
it <b>pushes</b> the changed state of the subject to the observers via
the <big><tt>update(Object newState)</tt></big> method in the <a
 target="_blank" href="Observer.java">Observer.java</a> file.<br>
      <br>
Alternatively, we could have used <b>pull</b> whereby when the subject
notifies the observers that the state of the subject has changed,
instead of the subject pushing the changed state to the observer, the
observer instead pulls the changed state from the subject.<br>
      </div>
      </td>
    </tr>
  </tbody>
</table>
<br>
<br>
<br>
<table width="50%" align="center" bgcolor="#9999ff" border="0"
 cellpadding="2" cellspacing="2">
  <tbody>
    <tr>
      <td valign="top">
      <div align="center"><b>Quick In-Class Quiz</b><br>
      </div>
      <br>
      <div align="center"> Provide some examples of
applications/problems where the observer pattern would be appropriate.<br>
      </div>
      </td>
    </tr>
  </tbody>
</table>
<br>
<br>
<span style="font-weight: bold;">The Observer Pattern in the Java API</span>:<br>
<br>
<br>
The observer pattern appeared in earliest implementation of the Java
API - 1.0 - through the <a target="_blank"
 href="http://docs.oracle.com/javase/6/docs/api/java/util/Observable.html">Observable</a>
class and <a target="_blank"
 href="http://docs.oracle.com/javase/6/docs/api/java/util/Observer.html">Observer</a>
interface. <br>
<br>
The auction example using the Java API:<br>
<br>
- <a target="_blank" href="java-observer/BidList.java">BidList.java</a><br>
<br>
- <a target="_blank" href="java-observer/Bidder.java">Bidder.java</a><br>
<br>
- <a target="_blank" href="java-observer/Auction.java">Auction.java</a><br>
<br>
The primary problem with this implementation is that <big><span
 style="font-family: monospace;">Observable</span></big> is a class,
not an
interface. (This violates what OO principle?)<br>
<br>
<br>
<span style="font-weight: bold;">The Lab</span><br>
<br>
Consider a stock trading system whereby there is a stock market&nbsp;
that keeps track of all trades of specific <b>stocks</b> (subjects)
and must inform all <b>traders</b> (observers) when a new trade has
been made for a certain stock. (Stocks are distinguished by short
acronyms (i.e. MSFT, GOOG, AAPL) and a trade of a specific stock be
either a buy or sell and it occurs at a
certain price.) Each stock subject will maintain a list of all traders
registered
with it and will notify each registered trader when a trade has been
made
for that specific stock. <br>
The UML for this scenario appears as:<br>
<br>
<img src="lab2-UML.jpg" alt="" height="253" width="591"> <br>
<br>
Details:<br>
<br>
You may use either the <big><span style="font-family: monospace;">Subject/Observer
</span></big>interfaces provided in this lab
or
the observer pattern available in the Java API.<br>
<span style="font-weight: bold;"></span><br>
1. Design the <big><tt>Trader</tt></big> <span
 style="font-weight: bold;"></span> class (which&nbsp; implements
either
the <a target="_blank" href="Observer.java">Observer</a> interface
or <a
 href="http://docs.oracle.com/javase/6/docs/api/java/util/Observer.html"
 target="_blank">java.util.Observer</a>.)<br>
<br>
2. Design the&nbsp;<span style="font-weight: bold;"></span><big><tt>Stock</tt></big>
class (which&nbsp; implements either the <a target="_blank"
 href="Subject.java">Subject</a> interface or extends the <a
 href="http://docs.oracle.com/javase/6/docs/api/java/util/Observable.html"
 target="_blank">java.util.Observable</a> class.)<br>
<br>
3. Write some test code that creates a StockMarket<span
 style="font-weight: bold;"></span> as well as a 2-3 of <big><tt>Stock</tt></big><span
 style="font-weight: bold;"></span> objects. Furthermore, create&nbsp;
2-3 <big><tt>Trader</tt></big> objects. Have the stock market register
each trader with a few stocks and then have the traders make trades for
those stocks. (Remember trades are either a buy or sell and occur at a
certain price.) Make
sure your test code illustrates how each trader is notified when a
trade for
the stock(s) they are registered for is made.<br>
<br>
You may find it helpful to model trades of each stock similar to the <a
 target="_blank" href="Bid.java">Bid.java</a> class.<br>
<br>
<blockquote><b>Question</b> --&gt; Does an object have to be an
observer to
make a trade<b>?</b><br>
</blockquote>
<br>
<table width="67%" align="center" bgcolor="#9999ff" border="0"
 cellpadding="2" cellspacing="2">
  <tbody>
    <tr>
      <td valign="top">
      <div align="center"><b>Done Early?</b><br>
      </div>
      <br>
Some choices:<br>
      <br>
- If you used the interfaces provided in this lab, change your
implementation to the Java API Observable/Observer (or vice-versa)<br>
      <br>
- If you used the Java API switch from push to pull (or vice-versa)<br>
      <br>
- If you used the interfaces provided in this lab, modify them so they
allow
pull.<br>
      <br>
      </td>
    </tr>
  </tbody>
</table>
<br>
</body>
</html>
